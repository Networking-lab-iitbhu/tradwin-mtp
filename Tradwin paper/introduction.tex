%!Tex root=./paper.tex
\section{Introduction}

The contemporary landscape of urban development is characterized by rapid urbanization and increasing population densities, presenting formidable challenges in optimizing traffic flow and urban infrastructure planning. Extensive research has documented the multifaceted impacts of traffic on public health\cite{levy2010evaluation}, economic viability\cite{gorea2016financial}, and social dynamics\cite{anciaes2017social}, highlighting the urgent need for advanced technological interventions.


The Digital Twin, as an emerging concept within cyber-physical systems (CPS), has garnered significant attention over the past decade, particularly with the advancements in big data, IoT connectivity, and affordable computing, which have rendered such systems increasingly practical\cite{guo2017mobile}\cite{singh2021digital}. A Digital Twin is a virtual representation of a real-world object, system, or process, meticulously designed to replicate its physical counterpart in the digital realm\cite{VANDERHORN2021113524}. This enables the Digital Twin to capture and simulate the intricate details of a physical entity, facilitating real-time monitoring, analysis, and prediction of its behavior. It transcends traditional 3D modeling by incorporating live data, sensor inputs, and advanced analytics, thereby providing a dynamic and interactive digital mirror of the physical world\cite{VANDERHORN2021113524}. This capability has found applications across a multitude of fields, including manufacturing, engineering, healthcare, urban planning, and beyond.

Our traffic digital twin, \name, serves as an interactive simulation of city traffic, continuously updating its internal state with real-time data from various sources. The proliferation of smart cities, equipped with IoT sensors and live camera feeds, has led to the development of numerous methodologies to enhance this capability. For example, the Sydney Coordinated Adaptive Traffic System (SCATS)\cite{scats} employs inductive loop-based sensors at traffic signals to monitor traffic volumes and is operational in over 180 cities across 28 countries, including New Zealand, Dublin, Shanghai, and Hong Kong\cite{wiki:sydney_traffic_system}. Cities such as New York and Los Angeles have implemented systems similar to SCATS. Additional techniques involve traffic probes\cite{zhu2012probe}, GPS-enabled mobile phones\cite{rose2006mobile}, exemplified by Google’s provision of congestion and travel time data, and deep learning computer vision models that utilize cameras to identify and count vehicles. These methods, however, primarily provide absolute volume counts at various nodes, rather than more granular data such as source-destination pairs, which present logistical and privacy challenges. In our study, we rely exclusively on absolute traffic volume data, without incorporating any information related to individual vehicles.

In the contemporary literature review, as discussed subsequently, mathematical and deep learning time series analysis methods prevail for tasks (i) and (ii). However, for task (iii), microscopic traffic simulation software such as SUMO \cite{sumo} and Vissim \cite{vissim} are commonly utilized. There are also approaches, for example by Kušić et al. (2023)\cite{kusic2023digital}, that use a macroscopic simulation model to create a digital twin of the city transport, continuously syncing with existing traffic data and then running a simulation with those parameters. These simulation engines are computationally intensive and require detailed information on vehicle types, origins, and destinations to produce accurate results, which may pose challenges in data acquisition. Another notable limitation of previous approaches, which predominantly focus on time series analysis, is their exclusive consideration of traffic flow data without accounting for potential exogenous variables such as weather \cite{weather}, holidays \cite{holiday}, and other contextual factors.

We argue that traffic dynamics are shaped by both intrinsic data relationships and external factors such as weather \cite{weather} and holidays \cite{holiday}. Moreover, there may be latent relationships among these variables that are not immediately evident. Thus, our proposed \name\ framework is designed to be highly adaptable, allowing for the inclusion of new features to enhance its predictive capacity.

In this paper, we aim to provide an end-to-end framework digital twin framework that first collects and aggregates real-time traffic data, updates its internal state parameters to reflect changes in the real world, along with use cases for consumption of that data like integration with city's traffic control systems and vehicle ADAS (Advanced Driver Assisted Systems). Our proposed framework utilizes the aggregated data to address three key tasks related to traffic modeling:
\begin{enumerate}[(i)]
\item \textbf{Traffic Prediction}: Predicting how traffic volume will change in the future based on a given traffic volume time series and historical data.
\item \textbf{Imputation}: For traffic volume time series with missing data (potentially due to sensor failure or other issues), our framework aims to accurately fill in the missing values.
\item \textbf{Re-assignment on Edge Addition or Removal}: Our objective is to predict how traffic flow will be affected by changes in the road network, such as the addition or removal of road segments.
\end{enumerate}
For each of the tasks, the architecture of our model remains the same, though it is to be trained independently for each of them. Attempts at unifying it across all tasks using multi-task learning could be a future direction of research.

Our proposed framework (i) takes input a graph representation of map where different regions are the vertices of the graph and different roads form the edges of the graph. (ii) Next, it encodes the structural features of graph nodes using Node2Vec \cite{node2vec} and  transforms them into feature embeddings. (iii) These embeddings are augmented with relevant traffic data and other semantic information, such as weather, encoded using Word2Vec \cite{word2vec}.
(iv) This encoded representation of the graph is used as input to an informed Wasserstein distance-based Generative Adversarial Imputation Net (GAIN), a modified version of the GAIN \cite{gain}, which is a type of conditional GAN. This adaptation incorporates elements from the Wasserstein GAN (WGAN) \cite{wgan}, enhancing GAN training effectiveness. Additionally, we integrate a modified loss function from physics-informed deep learning techniques \cite{pidl}, ensuring the model adheres to physical conservation laws.
(v) This proposed model is trained using real-world data and the trained model is used compute the tasks of prediction, imputation, and re-assignment of traffic.

To summarize, we outline the our contributions as follows:

\begin{enumerate}[(i)]
\item We introduce an end-to-end workflow for an interactive Traffic Digital Twin system that utilizes traffic volume data as its primary input.
\item We highlight how this can be integrated with existing traffic based systems as a Digital Twin of the physical traffic state.
\item Our proposed framework considers contextual data like geographical, meteorological, temporal data that are aggregated according to physical conservation laws.
\item We mathematically capture the dynamics involved in traffic modeling using physical laws.
\item Using this physics-informed traffic model, we develop a Wasserstein distance-based Generative Adversarial Imputation Net (GAIN) framework to predict and compute various tasks using real-world traffic data.
\end{enumerate}

